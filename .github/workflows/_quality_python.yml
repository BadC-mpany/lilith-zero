name: Python Quality

on:
  workflow_call:

permissions:
  contents: read

jobs:
  quality-python:
    name: Python Quality
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@b4ffde65f46336ab88eb53be808477a3936bae11 # v4.1.1
        with:
          persist-credentials: false

      - name: Install Python
        uses: actions/setup-python@0a5c61591373683505ea898e09a3ea4f39ef2b9c # v5.0.0
        with:
          python-version: "3.11"

      - name: Install uv
        uses: astral-sh/setup-uv@4db96194c378173c656ce18a155ffc14a9fc4355 # v5.1.0
        with:
          enable-cache: true
          cache-suffix: python-quality

      - name: Install Dependencies
        working-directory: sdk
        run: |
          uv pip install --system -e .[dev]

      - name: Lint (Ruff)
        working-directory: sdk
        run: uv run ruff check src/lilith_zero tests

      - name: Format Check (Ruff)
        working-directory: sdk
        run: uv run ruff format --check src/lilith_zero tests

      - name: Type Check (Mypy)
        working-directory: sdk
        run: uv run mypy src/lilith_zero tests --strict --ignore-missing-imports
