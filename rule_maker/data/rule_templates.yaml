rule_templates:
  - name: "prevent_basic_exfiltration"
    pattern:
      type: sequence
      steps:
        - class: SENSITIVE_READ
        - class: CONSEQUENTIAL_WRITE
      max_distance: null  # any distance
    action: BLOCK_SECOND
    severity: HIGH
    
  - name: "allow_sanitized_export"
    pattern:
      type: sequence
      steps:
        - class: SENSITIVE_READ
        - class: SANITIZER
        - class: CONSEQUENTIAL_WRITE
    action: ALLOW_ALL
    severity: LOW
    
  - name: "never_execute_after_sensitive"
    pattern:
      type: logic
      condition: 
        AND:
          - session_has_class: SENSITIVE_READ
          - current_tool_class: UNSAFE_EXECUTE
    action: BLOCK_CURRENT
    severity: CRITICAL