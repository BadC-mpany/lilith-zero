id: "hardening-demo-policy"
customerId: "demo-user"
name: "Hardened Policy"
version: 1
staticRules:
  read_user_db: "ALLOW"
  export_to_cloud: "ALLOW"
  ping: "ALLOW"

taintRules:
  # Rule 1: Reading DB adds PII taint
  - tool: "read_user_db"
    action: "ADD_TAINT"
    tag: "PII"

  # Rule 2: Exporting PII is FORBIDDEN
  - tool: "export_to_cloud"
    action: "CHECK_TAINT"
    forbiddenTags: ["PII"]
    error: "BLOCKED: Attempted to exfiltrate PII to external cloud storage."

enforceTrifectaProtection: true
trifectaToolClasses:
  read_user_db: [ACCESS_PRIVATE]
  export_to_cloud: [EXTERNAL_COMMUNICATION]
  ping: []
