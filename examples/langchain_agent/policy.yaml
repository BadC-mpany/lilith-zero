id: "langchain-policy"
customerId: "demo-user"
name: "LangChain Security Policy"
version: 1

staticRules:
  calculator: "ALLOW"
  read_customer_data: "ALLOW"
  export_analytics: "ALLOW"
  system_maintenance: "ALLOW"

taintRules:
  # 1. Source: Reading PII adds SENSITIVE taint
  - tool: "read_customer_data"
    action: "ADD_TAINT"
    tag: "SENSITIVE"
    
  # 2. Sink: Export blocked if SENSITIVE
  - tool: "export_analytics"
    action: "CHECK_TAINT"
    forbiddenTags: ["SENSITIVE"]
    error: "SECURITY BLOCK: Cannot export data containing customer PII."

  # 3. Logic: Maintenance only allowed in specific region
  - tool: "system_maintenance"
    action: "BLOCK"
    exceptions:
      - when:
          tool_args_match:
             region: "eu-west-1"
        reason: "Only eu-west-1 is authorized for maintenance."

resourceRules: []
protectLethalTrifecta: true
