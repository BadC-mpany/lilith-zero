name: langchain_demo_policy
version: 1
id: demo-policy-v1
customerId: internal-demo

staticRules:
  "calculator": "ALLOW"
  "read_customer_data": "ALLOW"
  "export_analytics": "ALLOW"      # Guarded by Taint
  "system_maintenance": "ALLOW"    # Guarded by Logic (Actually, let's use BLOCK in taint/logic rules overrides static? No, static is ACL. Let's Set ALLOW here and BLOCK in taint rules)
                                   # Wait, Logic Rules are Taint Rules with Pattern. 
                                   # So 'system_maintenance' must be allowed in static rules to reach the dynamic engine.
  "nuke_database": "DENY"

taintRules:
  # 1. Source: Add taint when reading sensitive data
  - tool: "read_customer_data"
    action: "ADD_TAINT"
    tag: "confidential"

  # 2. Sink: Block export if tainted
  - tool: "export_analytics"
    action: "CHECK_TAINT"
    forbiddenTags: ["confidential"]

  # 3. Logic: Logic-based Access Control
  - tool: "system_maintenance"
    action: "BLOCK"
    error: "Maintenance only allowed in 'eu-west-1'"
    exceptions:
      - when:
          tool_args_match:
             region: "eu-west-1"
        reason: "Region Allowed"
