id: "enterprise-policy"
customerId: "acme-corp"
name: "Enterprise Security Policy"
version: 1

staticRules:
  get_current_time: "ALLOW"
  get_user_profile: "ALLOW"
  upload_to_archive: "ALLOW"
  export_to_untrusted_cloud: "ALLOW"
  sanitize_data: "ALLOW"
  execute_system_command: "ALLOW"

taintRules:
  # 1. Source: Accessing profile adds SENSITIVE taint
  - tool: "get_user_profile"
    action: "ADD_TAINT"
    tag: "SENSITIVE"
    
  # 2. Cleaner: Sanitize tool removes SENSITIVE taint
  - tool: "sanitize_data"
    action: "REMOVE_TAINT"
    tag: "SENSITIVE"

  # 3. Sink: Untrusted cloud blocks SENSITIVE data
  - tool: "export_to_untrusted_cloud"
    action: "CHECK_TAINT"
    forbiddenTags: ["SENSITIVE"]
    error: "SECURITY VIOLATION: Export of sensitive profiles to untrusted clouds is forbidden."

  # 4. Logic: Block execute_system_command unless 'force' is 'true'
  - tool: "execute_system_command"
    action: "BLOCK"
    exceptions:
      - when:
          tool_args_match:
             force: "true"
        reason: "Force operations are authorized."

resourceRules:
  # 5. Resource Control: Allow only specific URI patterns
  - uriPattern: "s3://public/*"
    action: "ALLOW"
  - uriPattern: "s3://internal/*"
    action: "BLOCK"
    exceptions:
      - when: false
        reason: "Strictly internal"

protectLethalTrifecta: true
