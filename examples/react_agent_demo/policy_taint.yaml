name: "taint_policy"
version: 1
id: "policy-taint-001"
customerId: "demo-user"

# NO sandbox section - policy enforcement only

# Static Allowlist (Safe Tools)
staticRules:
  analyze_data: "ALLOW"
  get_financial_report: "ALLOW"
  upload_to_cloud: "ALLOW" 
  unauthorized_read: "ALLOW"

# Taint Tracking Rules
taintRules:
  # 1. Reading reports adds CONFIDENTIAL taint
  - tool: "get_financial_report"
    action: "ADD_TAINT"
    tag: "CONFIDENTIAL"

  # 2. Uploading requires checking for confidential data leak
  - tool: "upload_to_cloud"
    action: "CHECK_TAINT"
    forbiddenTags: ["CONFIDENTIAL"]
    error: "Policy Violation: Exfiltration of confidential data blocked."

  # 3. Block unauthorized file reads at the policy layer (Sandbox Safety Net)
  - tool: "unauthorized_read"
    action: "CHECK_TAINT"
    # This is a simplified resource check for the demo
    # In a full implementation, we'd use resourceRules

# Resource Rules
resourceRules: []
